(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{451:function(e,t,s){"use strict";s.d(t,"a",(function(){return b}));var a=s(5),i=s(6),n=s(8),l=s(1),r=s(14),c=s(111),o=s(12),u=(s(309),s(0));const d=Object(u.forwardRef)(({data:e,loading:t,value:s,refList:d,canRead:b,isMulti:f,search:g,autoFocus:j,serverErrors:m,onChange:h,htmlID:p,setSearch:O,selectProps:y,fetchMore:v,isDisabled:x},N)=>{const $=e&&e[d.gqlNames.listQueryName]?e[d.gqlNames.listQueryName].map(e=>({value:e,label:e._label_})):[],D=m&&m.find(e=>e instanceof Error&&"AccessDeniedError"===e.name);let k=null;const q=e=>"string"==typeof e?$.find(t=>t.value.id===e)||{label:e,value:e}:{label:e._label_,value:e};null!==s&&b&&(f?k=(Array.isArray(s)?s:[]).map(q):s&&(k=q(s)));const C=e&&e[d.gqlNames.listQueryMetaName]?e[d.gqlNames.listQueryMetaName].count:0,M=Object(u.useMemo)(()=>({MenuList:e=>{let{children:t}=e,s=Object(n.a)(e,["children"]);const a=Object(u.useRef)(null),c=r.gql`
            query RelationshipSelectMore($search: String!, $first: Int!, $skip: Int!) {
              ${d.gqlNames.listQueryName}(search: $search, first: $first, skip: $skip) {
                _label_
                id
              }
            }
          `;return function(e,t){Object(u.useEffect)(()=>{let s=new IntersectionObserver(e,{}),a=t.current;if(null!==a)return s.observe(a),()=>s.unobserve(a)})}(([{isIntersecting:e}])=>{!s.isLoading&&e&&s.options.length<C&&v({query:c,variables:{search:g,first:50,skip:s.options.length},updateQuery:(e,{fetchMoreResult:t})=>t?Object(i.a)(Object(i.a)({},e),{},{[d.gqlNames.listQueryName]:[...e[d.gqlNames.listQueryName],...t[d.gqlNames.listQueryName]]}):e})},a),Object(l.jsx)(o.f.MenuList,s,t,Object(l.jsx)("div",{css:{textAlign:"center"},ref:a},s.options.length<C&&Object(l.jsx)("span",{css:{padding:8}},"Loading...")))}}),[C,d.gqlNames.listQueryName]);return Object(l.jsx)(c.a,Object(a.a)({onInputChange:e=>O(e),isLoading:t,autoFocus:j,isMulti:f,components:M,getOptionValue:e=>e.value.id,value:k,placeholder:b?void 0:D&&D.message,options:$,onChange:h,id:"react-select-"+p,isClearable:!0,instanceId:p,inputId:p,innerRef:N,menuPortalTarget:document.body,isDisabled:x},y))}),b=({innerRef:e,autoFocus:t,field:s,errors:a,renderContext:i,htmlID:n,onChange:c,isMulti:o,value:b,isDisabled:f})=>{const[g,j]=Object(u.useState)(""),m=s.getRefList(),h=r.gql`
    query RelationshipSelect($search: String!, $first: Int!, $skip: Int!) {
      ${m.gqlNames.listQueryName}(search: $search, first: $first, skip: $skip) {
        _label_
        id
      }

      ${m.gqlNames.listQueryMetaName}(search: $search) {
        count
      }
    }
  `,p=!a||a.every(e=>!(e instanceof Error&&"AccessDeniedError"===e.name)),O="dialog"===i?{menuShouldBlockScroll:!0}:null,{data:y,error:v,loading:x,fetchMore:N}=Object(r.useQuery)(h,{fetchPolicy:"network-only",variables:{search:g,first:10,skip:0}});return v?(console.log("ERROR!!!",v),"Error"):Object(l.jsx)(d,{data:y,loading:x,value:b,refList:m,canRead:p,isMulti:o,search:g,autoFocus:t,serverErrors:a,onChange:c,htmlID:n,setSearch:j,selectProps:O,fetchMore:N,ref:e,isDisabled:f})}},484:function(e,t,s){"use strict";s.r(t);var a=s(6),i=s(1),n=s(0),l=s(14),r=s(82),c=s(10),o=s(2),u=s(9),d=s(65),b=s(451),f=s(169);s(150),s(149),s(111),s(309);function g({listKey:e,value:t,onAddUser:s,many:a,isDisabled:n}){const r="authenticated"+e,{data:b}=Object(l.useQuery)(l.gql`
    query User {
      ${r} {
        _label_
        id
      }
    }
  `);if(b&&b[r]){const e=b[r].id;if(null!==t&&(a?t.some(t=>t.id===e):t.id===e))return null;const l=`${a?"Add":"Set as"} ${b[r]._label_}`;return Object(i.jsx)(d.a,{placement:"top",content:l},e=>Object(i.jsx)(u.b,{css:{marginLeft:o.d},variant:"ghost",ref:e,onClick:()=>{s(b[r])},icon:c.n,"aria-label":l,isDisabled:n}))}return null}function j({field:e,value:t}){const{many:s}=e.config,{fullPath:a}=e.getRefList();let n,l=!1,r=a;return s?(n="View List of Related Items",t.length||(l=!0),r=`${r}?!id_in="${t.slice(0,100).map(({id:e})=>e).join(",")}"`):(n="View Item Details",t?r=`${r}/${t.id}`:l=!0),Object(i.jsx)(d.a,{placement:"top",content:n},e=>Object(i.jsx)(u.b,{ref:e,icon:c.k,"aria-label":n,variant:"ghost",css:{marginLeft:o.d},target:"_blank",to:r,isDisabled:l}))}function m({field:e,item:t,onCreate:s,isDisabled:l}){const{list:r,openCreateItemModal:b}=Object(f.f)();let g,j=e.getRefList(),m="Create and add "+j.singular;return t&&t.id&&(g=j.fields.filter(t=>"Relationship"===t.type&&t.config.ref===r.key&&t.config.refFieldPath===e.path).reduce((e,s)=>{const i={_label_:t._label_||"<link to parent>",id:t.id};return Object(a.a)(Object(a.a)({},e),{},{[s.path]:s.config.many?[i]:i})},{})),Object(i.jsx)(n.Fragment,null,Object(i.jsx)(d.a,{placement:"top",content:m},e=>Object(i.jsx)(u.b,{ref:e,onClick:b,icon:c.o,"aria-label":m,variant:"ghost",css:{marginLeft:o.d},isDisabled:l})),Object(i.jsx)(f.b,{prefillData:g,onCreate:({data:e})=>{s(e[j.gqlNames.createMutationName])}}))}t.default=({autoFocus:e,field:t,value:s=[],renderContext:a,errors:n,onChange:l,item:c,list:o,isDisabled:u})=>{const{many:d,ref:h}=t.config,{authStrategy:p}=Object(f.e)(),O="ks-input-"+t.path,y=t.getRefList();return Object(i.jsx)(r.a,null,Object(i.jsx)(r.d,{htmlFor:O,field:t,errors:n}),Object(i.jsx)(r.b,{text:t.adminDoc}),Object(i.jsx)(r.c,null,Object(i.jsx)("div",{css:{flex:1}},Object(i.jsx)(b.a,{autoFocus:e,isMulti:d,field:t,value:s,errors:n,renderContext:a,htmlID:O,onChange:e=>{const{many:s}=t.config;l(s?e?e.map(e=>e.value):[]:e?e.value:null)},isDisabled:u})),Object(i.jsx)(f.c,{list:y},Object(i.jsx)(m,{onCreate:e=>{l(d?s.concat(e):e)},field:t,item:c,list:o,isDisabled:u})),p&&h===p.listKey&&Object(i.jsx)(g,{many:d,onAddUser:e=>{l(d?s.concat(e):e)},value:s,listKey:p.listKey,isDisabled:u}),Object(i.jsx)(j,{field:t,value:s})))}}}]);