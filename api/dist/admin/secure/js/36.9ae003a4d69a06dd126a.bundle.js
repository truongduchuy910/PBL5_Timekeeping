(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{576:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(198),i=n.p+"3ab7ad6384fa7459980143f40e823efc.svg",c=n(29),u=n.n(c),l=n(357),s=n(92);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){d(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){v(o,r,a,i,c,"next",e)}function c(e){v(o,r,a,i,c,"throw",e)}i(void 0)}))}}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var b,m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.url="http://b88dbc29ad5c.ngrok.io",this.option={headers:{Accept:"application/json","Content-type":"application/json"},method:"POST",redirect:"follow"},this.url=t}var t,n,r,a,o,i,c,l,s;return t=e,(n=[{key:"uploadByUrls",value:(s=h(u.a.mark((function e(t,n){var r,a,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.isAvailable();case 3:r=e.sent,console.log("status",r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("status",!1);case 10:if(!r){e.next=0;break}case 11:return a="".concat(this.url,"/uploadByUrls"),o=JSON.stringify({url_list:t,txtusername:n}),e.next=15,fetch(a,p(p({},this.option),{},{body:o}));case 15:return i=e.sent,e.abrupt("return",200===i.status);case 17:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e,t){return s.apply(this,arguments)})},{key:"train",value:(l=h(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.isAvailable();case 3:t=e.sent,console.log("status",t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("status",!1);case 10:if(!t){e.next=0;break}case 11:return e.prev=11,n="".concat(this.url,"/trainning"),e.next=15,fetch(n,{headers:{Accept:"application/json","Content-type":"application/json"},method:"GET",redirect:"follow"});case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(11),console.log("cannot call train");case 20:return e.prev=20,e.next=23,this.isAvailable();case 23:t=e.sent,console.log("status",t),e.next=30;break;case 27:e.prev=27,e.t2=e.catch(20),console.log("status",!1);case 30:if(!t){e.next=20;break}case 31:case"end":return e.stop()}}),e,this,[[0,7],[11,17],[20,27]])}))),function(){return l.apply(this,arguments)})},{key:"getIdByUrls",value:(c=h(u.a.mark((function e(t){var n,r,a,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.isAvailable();case 3:n=e.sent,console.log("status",n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("status",!1);case 10:if(!n){e.next=0;break}case 11:return r="".concat(this.url,"/identifiedStrList"),a=JSON.stringify({url_list:t}),e.next=15,fetch(r,p(p({},this.option),{},{body:a}));case 15:if(200!==(o=e.sent).status){e.next=23;break}return e.next=19,o.json();case 19:return i=e.sent,e.abrupt("return",i);case 23:console.error(o.status,o.statusText);case 24:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return c.apply(this,arguments)})},{key:"getIdByUrl",value:(i=h(u.a.mark((function e(t){var n,r,a,o,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.isAvailable();case 3:n=e.sent,console.log("status",n),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("status",!1);case 10:if(!n){e.next=0;break}case 11:return r="".concat(this.url,"/identifiedStr"),a=JSON.stringify({url:t}),e.next=15,fetch(r,p(p({},this.option),{},{body:a}));case 15:if(200!==(o=e.sent).status){e.next=23;break}return e.next=19,o.json();case 19:return i=e.sent,e.abrupt("return",i);case 23:console.error(o.statusText);case 24:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(e){return i.apply(this,arguments)})},{key:"isAvailable",value:(o=h(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(this.url,"/checkAvailable"),e.next=3,fetch(t,{headers:{Accept:"application/json","Content-type":"application/json"},method:"GET",redirect:"follow"});case 3:return n=e.sent,e.abrupt("return",200===n.status);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"deleteById",value:(a=h(u.a.mark((function e(t){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(this.url,"/deleteById"),r=JSON.stringify({id:t}),e.next=4,fetch(n,p(p({},this.option),{},{body:r}));case 4:return a=e.sent,e.abrupt("return",200===a.status);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})}])&&y(t.prototype,n),r&&y(t,r),e}(),g=n(573),w=n(536),x=n(577);function j(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function E(e){var t=e.user,n=e.url,o=O(Object(r.useState)(),2),i=o[0],c=o[1],l=function(){var e,t=(e=u.a.mark((function e(t){var r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=2;break}return e.abrupt("return");case 2:if(c(!0),r=t.faces,!(a=(void 0===r?[]:r).map((function(e){return encodeURI("https://timekeeping.itoa.vn"+e.file.publicUrl)}))).length){e.next=13;break}return o=new m(n),console.log("delete",n,a,t.id),e.next=10,o.deleteById(t.id);case 10:return console.log("upload",n,a,t.id),e.next=13,o.uploadByUrls(a,t.id);case 13:c(!1);case 14:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){j(o,r,a,i,c,"next",e)}function c(e){j(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",{style:{marginBottom:34}},a.a.createElement(g.a,{gridTemplateColumns:"repeat(2, auto)",gridGap:3},a.a.createElement(w.a,{p:3},a.a.createElement("h5",null,t.name),a.a.createElement("small",null,t.id),a.a.createElement("hr",null),t.faces.map((function(e){return a.a.createElement("span",{key:e.id})}))),a.a.createElement(w.a,{p:3,color:"text.inverse"},a.a.createElement(x.a,{size:"xs",onClick:function(e){l(t)}},i?"loading...":"upload"))))}function A(e){var t,n,o=e.onTrain,i=e.url,c=Object(l.a)(Object(s.a)(b||(t=["\n      query {\n        allUsers {\n          id\n          name\n          isAdmin\n          faces {\n            id\n            file {\n              publicUrl\n            }\n          }\n        }\n      }\n    "],n||(n=t.slice(0)),b=Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}}))))),u=c.loading,f=c.error,p=c.data,d=(void 0===p?{}:p).allUsers,v=void 0===d?[]:d,h=Object(r.useMemo)((function(){return v.map((function(e){return!e.isAdmin&&a.a.createElement(E,{key:e.id,user:e,url:i})}))}),[v,i]);return u?"Loaing...":f||a.a.createElement("div",null,h,a.a.createElement(x.a,{onClick:function(e){o(v)}},"train"))}var S,P=n(574);function T(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){T(o,r,a,i,c,"next",e)}function c(e){T(o,r,a,i,c,"throw",e)}i(void 0)}))}}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e){var t=e.url,n=I(Object(r.useState)(),2),o=n[0],i=n[1],c=new m(t);return Object(r.useEffect)(U(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout(U(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.isAvailable();case 2:t=e.sent,i(t);case 4:case"end":return e.stop()}}),e)}))),1e3);case 1:case"end":return e.stop()}}),e)})))),a.a.createElement("div",null,a.a.createElement("small",null,o?"done":"training"))}function F(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,c=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(e){c=!0,a=e}finally{try{i||null==n.return||n.return()}finally{if(c)throw a}}return o}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function D(){var e,t,n=Object(l.a)(Object(s.a)(S||(e=["\n    query {\n      allTFaces {\n        id\n        url\n      }\n    }\n  "],t||(t=e.slice(0)),S=Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))))),o=n.loading,i=n.error,c=n.data,f=void 0===c?{allTFaces:[{}]}:c,p=J(f.allTFaces,1)[0].url,d=function(){var e,t=(e=u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new m(p),console.log("train start"),e.next=4,n.train();case 4:console.log("train end");case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){F(o,r,a,i,c,"next",e)}function c(e){F(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),v=Object(r.useMemo)((function(){return a.a.createElement(A,{url:p,onTrain:d})}),[f]);return o?"loading...":i?i.toString():a.a.createElement(P.a,null,a.a.createElement(w.a,{p:2},a.a.createElement(B,{url:p}),a.a.createElement("hr",{style:{marginBottom:34}}),v))}t.default={listHeaderActions:function(){return a.a.createElement("div",null,a.a.createElement(o.a,null))},logo:function(){return a.a.createElement(r.Fragment,null,a.a.createElement("div",{style:{textAlign:"end",color:"#6c757d"}},a.a.createElement("img",{src:i,style:{maxWidth:300}}),a.a.createElement("p",{style:{maxWidth:400}},"Created and developed by students of Da Nang University of Science and Technology")))},pages:function(e){return[{path:"/train",label:"# Train",component:D},{listKey:"Report",label:"# Report"},{listKey:"Shift",label:"# Shift"},{listKey:"User",label:"# User"},{listKey:"TFace",label:"# TFace"}]}}}}]);